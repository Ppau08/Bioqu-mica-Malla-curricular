<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Bioquímica Interactiva</title>
  <style>
    body {
  font-family: serif;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  color: #1c0312; /* opcional: mejora el contraste del texto si el fondo es oscuro */
    }

    h1 {
      text-align: center;
      margin-bottom: 40px;
    }

    .container {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      justify-content: center;
    }

    .year-column {
      background-color: #E5C7D6;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      width: 220px;
      margin: 0 10px;
      flex-shrink: 0;
    }

    .year-column h2 {
      text-align: center;
      color: #fff;
      background-color: #821D59;
      margin: 0;
      padding: 10px;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
      font-size: 18px;
    }

    .cuatrimestre {
      border-top: 3px solid #F7EEED;
      padding: 10px;
    }

    .cuatrimestre h3 {
      text-align: center;
      margin: 10px 0;
      font-size: 16px;
    }

    .materia {
      background-color: #FFFFFF;
      border: 2px solid #F7EEED;
      border-radius: 8px;
      margin: 8px 0;
      padding: 10px;
      text-align: center;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .espera {
      background-color: #E5C7D6;
      cursor: default;
      pointer-events: none;
    }

    .materia.estado-1 {
      background-color: #E2EAC2;
    }

    .materia.estado-2 {
      background-color: #A7AF80;
      text-decoration: line-through;
      color: #1c0312;
    }
  </style>
</head>
<body>
  <script>
    const malla = [
      {
        anio: 1,
        cuatrimestres: [
          {
            color: 'verde',
            materias: [
              { nombre: 'Álgebra y Geometría Analítica', id: 'algebra', correlativas: [] },
              { nombre: 'Química General', id: 'quim_gen', correlativas: [] },
            ]
          },
          {
            color: 'rojo',
            materias: [
              { nombre: 'Cálculo Diferencial e Integral', id: 'calculo', correlativas: ['algebra'] },
              { nombre: 'Química Inorgánica', id: 'quim_inorg', correlativas: ['quim_gen'] },
              { nombre: 'Biología General y Celular', id: 'biologia', correlativas: ['quim_gen'] },
            ]
          }
        ]
      },
      // Resto de años se agregan similar
    ];

    const estadoMaterias = {};

    function crearMalla() {
      malla.forEach(anio => {
        const col = document.createElement('div');
        col.className = 'anio';
        col.innerHTML = `<h2>${anio.anio}°</h2>`;

        anio.cuatrimestres.forEach(cuat => {
          const cuatDiv = document.createElement('div');
          cuatDiv.className = `cuatrimestre ${cuat.color}`;

          cuat.materias.forEach(mat => {
            const matDiv = document.createElement('div');
            matDiv.className = 'materia bloqueada';
            matDiv.innerText = mat.nombre;
            matDiv.dataset.id = mat.id;
            matDiv.addEventListener('click', () => cambiarEstado(matDiv));
            estadoMaterias[mat.id] = 'bloqueada';
            cuatDiv.appendChild(matDiv);
          });

          col.appendChild(cuatDiv);
        });

        document.body.appendChild(col);
      });

      actualizarEstados();
    }

    function cambiarEstado(div) {
      const id = div.dataset.id;
      let estado = estadoMaterias[id];

      if (estado === 'bloqueada') return;
      else if (estado === 'desbloqueada') estadoMaterias[id] = 'regularizada';
      else if (estado === 'regularizada') estadoMaterias[id] = 'aprobada';
      else estadoMaterias[id] = 'desbloqueada';

      actualizarEstados();
    }

    function actualizarEstados() {
      document.querySelectorAll('.materia').forEach(div => {
        const id = div.dataset.id;
        div.className = 'materia ' + estadoMaterias[id];
      });

      desbloquearMaterias();
    }

    function desbloquearMaterias() {
      malla.forEach(anio => {
        anio.cuatrimestres.forEach(cuat => {
          cuat.materias.forEach(mat => {
            if (estadoMaterias[mat.id] === 'bloqueada') {
              const puede = mat.correlativas.every(c => estadoMaterias[c] === 'regularizada' || estadoMaterias[c] === 'aprobada');
              if (puede) estadoMaterias[mat.id] = 'desbloqueada';
            }
          });
        });
      });
    }

    crearMalla();
  </script>
</body>
</html>

